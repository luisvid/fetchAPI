<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
        media="screen" />
    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.1/animate.min.css" />

    <script src="https://code.jquery.com/jquery-1.12.3.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.2.0/anchor.js"></script>

    <script src="http://bootboxjs.com/bootbox.js"></script>

    <title>FORMULARIO DE INSCRIPCION</title>
</head>

<body>
    <div class="w3-container">
        <h1>FORMULARIO DE INSCRIPCION</h1>
        <h2>Curso anual preuniversitario de Ingeniería | Ingreso 2019</h2>

        <form id="postData" onsubmit="return checkForm(this)">

            <div>
                <h2>Datos Alumno</h2>
            </div>

            </p>
            <div class="form-group">
                <div class="form-group">
                    <label>Nombre</label>
                    <input type="text" name="nombre" class="form-control" id="nombre">
                </div>

                </p>
                <div class="form-group">
                    <label>Apellido</label>
                    <input type="text" name="apellido" class="form-control" id="apellido">
                </div>

                </p>
                <div class="form-group">
                    <label>Documento</label>
                    <input type="text" name="documento" class="form-control" id="documento"></div>

                </p>
                <div class="form-group">
                    <label>Fecha de nacimiento</label>
                    <input type="text" name="fechaNacimiento" class="form-control" id="fechaNacimiento"></div>

                </p>
                <div class="form-group">
                    <label>Domicilio</label>
                    <input type="text" name="domicilioModel.domicilio" class="form-control" id="domicilio"></div>

                </p>
                <div class="form-group">
                    <label>Teléfono alumno</label>
                    <input type="text" name="telefonoModel.telefono" class="form-control" placeholder="código de área sin el cero y celular sin el 15"
                        id="telefono"></div>

                </p>
                <div class="form-group">
                    <label>Correo Electrónico</label>
                    <input type="text" name="email" class="form-control" id="email"></div>

                </p>
                <div class="form-group">
                    <label>Teléfono Contacto</label>
                    <input type="text" name="telefonoContactoModel.telefono" class="form-control" id="telefonoContacto"></div>

                </p>
                <div class="form-group">
                    <label>Correo Electrónico Padre</label>
                    <input type="text" name="emailPadre" class="form-control" id="emailPadre"></div>

                </p>
                <div class="form-group">
                    <label>¿Estás haciendo el secundario?</label>
                    <input type="checkbox" name="haciendoSecundario" class="form-control" id="haciendoSecundario"></div>

                </p>
                <div class="form-group">
                    <label>Horarios de cursado</label>
                    <input type="text" name="horariosCursadoSecundario" class="form-control" id="horariosCursadoSecundario"></div>

                </p>
                <div class="form-group">
                    <label>¿Trabajás?</label>
                    <input type="checkbox" name="trabaja" class="form-control" id="trabaja"></div>

                </p>
                <div class="form-group">
                    <label>Horarios en los que trabajas</label>
                    <input type="text" name="horariosTrabaja" class="form-control" id="horariosTrabaja"></div>

                </p>
                <div class="form-group">
                    <label>¿Realizás alguna otra actividad regularmente?</label>
                    <input type="checkbox" name="actividad" class="form-control" id="actividad"></div>

                </p>
                <div class="form-group">
                    <label>Descripción de la actividad</label>
                    <input type="text" name="descripcionActividad" class="form-control" id="descripcionActividad"></div>

                </p>
                <div class="form-group">
                    <label>Horarios en los que realiza la actividad</label>
                    <input type="text" name="horariosActividad" class="form-control" id="horariosActividad"></div>

                </p>
                <div class="form-group">
                    <label>¿Por qué querés estudiar en la universidad?</label>
                    <input type="text" name="porQueEstudiaUniversidad" class="form-control" id="porQueEstudiaUniversidad"></div>

                </p>
                <label>¿Qué carrera querés estudiar?</label>
                <div class="form-group">
                    <select name="carrera">
                        <option value="1">Carrera universitaria 1</option>
                        <option value="2">Carrera universitaria 2</option>
                        <option value="3">Carrera universitaria 3</option>
                        <option value="4">Carrera universitaria 4</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>¿Por qué?</label>
                    <input type="text" name="porQueEstudiaCarrera" class="form-control" id="porQueEstudiaCarrera"></div>
                </p>
                <div class="form-group">
                    <label>¿Te llama la atención alguna otra carrera? ¿Cuál? ¿Por qué?</label>
                    <input type="text" name="otraCarrera" class="form-control" id="otraCarrera"></div>

                </p>
                <div class="form-group">
                    <label>¿Es tu primer intento en ingresar a la universidad?</label>
                    <input type="text" name="primerIntento" class="form-control" id="primerIntento"></div>

                </p>
                <div class="form-group">
                    <label>¿Cuantas horas al día tenés para dedicarle al preuniversitario?</label>
                    <input type="text" name="horasDedicacionPre" class="form-control" id="horasDedicacionPre"></div>

                </p>
                <div class="form-group">
                    <label>¿Cuantas horas al día estás dispuesto a estudiar para alcanzar tu meta?</label>
                    <input type="text" name="horasEstudio" class="form-control" id="horasEstudio"></div>

                </p>
                <div class="form-group">
                    <label>¿Por qué elegiste EGG?</label>
                    <input type="text" name="porQueElegisteEgg" class="form-control" id="porqueElegisteEgg"></div>

                </p>
                <div class="form-group">
                    <label>¿Cómo te enteraste de EGG?</label>
                    <input type="text" name="comoTeEnterasteEgg" class="form-control" id="comoTeEnterasteEgg"></div>

                <div>
                    <h2>FICHA MEDICA</h2>
                </div>

                </p>
                </p>
                <div class="form-group">
                    <label>Diabetes</label>
                    <input type="checkbox" name="diabetes" class="form-control" id="diabetes"></div>

                </p>
                <div class="form-group">
                    <label>Hipertensión Arterial</label>
                    <input type="checkbox" name="hipertencionArterial" class="form-control" id="hipertencionArterial"></div>

                </p>
                <div class="form-group">
                    <label>Alergias</label>
                    <input type="checkbox" name="alergias" class="form-control" id="alergias"></div>

                </p>
                <div class="form-group">
                    <label>Afecciones Respiratoria</label>
                    <input type="checkbox" name="afeccionRespiratoria" class="form-control" id="afeccionRespiratoria"></div>

                </p>
                <div class="form-group">
                    <label>Afecciones Cardiovasculares</label>
                    <input type="checkbox" name="afeccionCardiovascular" class="form-control" id="afeccionCardiovascular"></div>

                </p>
                <div class="form-group">
                    <label>Afecciones Neurológicas</label>
                    <input type="checkbox" name="afeccionNeurologica" class="form-control" id="afeccionNeurologica"></div>

                </p>
                <div class="form-group">
                    <label>Medicación Permanente</label>
                    <input type="checkbox" name="medicamentoPermanente" class="form-control" id="medicamentoPermanente"></div>

                </p>
                </p>

                <button id="boton" type="button" onclick="guardar()">Enviar</button>

        </form>

    </div>

    <script type="text/javascript">

        // 
        function guardar() {

            if (checkForm(postData)) {
                $.ajax({
                    url: 'http://localhost:8080/api/ficha/alumno/guardar',
                    type: 'POST',
                    data: $("#postData").serialize(),
                    success: function (data) {
                        if (data.error != null) {
                            bootbox.alert(data.error);
                        } else {
                            bootbox.alert(data.mensaje);
                            window.location = "https://eggeducacion.com";
                        }
                    },
                    error: function () {
                        alert("ERROR");
                    }
                });
            }

        }


        // Validaciones de campos
        function checkForm(form) {

            errMsg = "";

            if (this.nombre.value == "" || this.apellido.value == "") {
                errMsg = "- El nombre y apellido debe estar completo.\n";
            }

            if (this.documento.value == "" || isNaN(this.documento.value)) {
                errMsg = errMsg + "- Ingresa el número de documento sin puntos.\n";
            }

            if (this.fechaNacimiento.value == "" || !isValidDate(this.fechaNacimiento.value)) {
                errMsg = errMsg + "- Ingresa la fecha de nacimiento con formato día/mes/año.\n";
            }

            if (this.domicilio.value == "") {
                errMsg = errMsg + "- Ingresa el domicilio.\n";
            }

            if (this.telefono.value == "" || isNaN(this.telefono.value)) {
                errMsg = errMsg + "- Ingresa solo números en el teléfono del alumno.\n";
            }

            if (!validateEmail(this.email.value)) {
                errMsg = errMsg + "- Ingresa una dirección de email correcta.\n";
            }

            if (this.telefonoContacto.value == "" || isNaN(this.telefono.value)) {
                errMsg = errMsg + "- Ingresa solo números en teléfono de contacto.\n";
            }

            if (!validateEmail(this.emailPadre.value)) {
                errMsg = errMsg + "- Ingresa una dirección de email de padre correcta\n";
            }

            if (this.haciendoSecundario.checked && this.horariosCursadoSecundario.value == "") {
                errMsg = errMsg + "- Ingresa el horario de cursado de secundario.\n";
            }

            if (this.trabaja.checked && this.horariosTrabaja.value == "") {
                errMsg = errMsg + "- Ingresa el horario de trabajo.\n";
            }

            if (this.actividad.checked && (this.descripcionActividad.value == "" || this.horariosActividad.value == "")) {
                errMsg = errMsg + "- Completa la información sobre la actididad.\n";
            }

            if (this.porQueEstudiaUniversidad.value == "") {
                errMsg = errMsg + "- Contesta porque estudiar en la universidad.\n";
            }

            if (this.porQueEstudiaCarrera.value == "") {
                errMsg = errMsg + "- Contesta porque elegiste esa carrera.\n";
            }

            if (this.horasDedicacionPre.value == "" || isNaN(this.horasDedicacionPre.value)) {
                errMsg = errMsg + "- Ingresa el número de horas de dedicación al pre.\n";
            }

            if (this.horasEstudio.value == "" || isNaN(this.horasEstudio.value)) {
                errMsg = errMsg + "- Ingresa el número de horas de dedicacion al estudio.\n";
            }

            if (this.porqueElegisteEgg.value == "") {
                errMsg = errMsg + "- Contesta porque elegiste Egg.\n";
            }

            if (this.comoTeEnterasteEgg.value == "") {
                errMsg = errMsg + "- Contesta como te enteraste de Egg.\n";
            }

            if (errMsg != "") {
                alert("Se produjeron los siguientes errores al validar el formulario:\n" + errMsg);
                return false;

            } else {
                // bootbox.alert("Success!  The form has been completed, validated and is ready to be submitted...");
                return true;
            }

            return true;
        }

        // Validates that the input string is a valid date formatted as "dd/mm/yyyy"
        function isValidDate(dateString) {
            // First check for the pattern
            if (!/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(dateString))
                return false;

            // Parse the date parts to integers
            var parts = dateString.split("/");
            var day = parseInt(parts[0], 10);
            var month = parseInt(parts[1], 10);
            var year = parseInt(parts[2], 10);

            // Check the ranges of month and year
            if (year < 1000 || year > 3000 || month == 0 || month > 12)
                return false;

            var monthLength = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

            // Adjust for leap years
            if (year % 400 == 0 || (year % 100 != 0 && year % 4 == 0))
                monthLength[1] = 29;

            // Check the range of the day
            return day > 0 && day <= monthLength[month - 1];
        }

        function validateEmail(email) {
            var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            return re.test(email);
        }

    </script>

</body>

</html>